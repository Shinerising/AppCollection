var y=Object.defineProperty;var g=(n,t,e)=>t in n?y(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var d=(n,t,e)=>(g(n,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}})();class r{}d(r,"URL","app.awayne.me"),d(r,"Owner","Shinerising"),d(r,"API","https://github-api.crscd.net/api"),d(r,"User","https://github-api.crscd.net/users"),d(r,"Content","https://github-api.crscd.net/content"),d(r,"Download","https://github-api.crscd.net/download"),d(r,"ImageProxy","https://github-api.crscd.net/img");const $={en:{SITE_TITLE:"Application Collection",PAGE_TITLE:"Application Collection",BRIEF_NULL:"No brief.",BUTTON_DOCUMENT:"Document",BUTTON_PREVIEW:"Preview",BUTTON_PACKAGE:"Package",BUTTON_GITHUB:"Source code",BUTTON_DEMO:"Demo",SEARCH_PLACEHOLDER:"Search",LABEL_PREVIEW:"Preview",LABEL_PLATFORM_ALL:"All"},zh:{SITE_TITLE:"软件集合",PAGE_TITLE:"科研成果及应用软件合集",BRIEF_NULL:"暂无简介。",BUTTON_DOCUMENT:"查看说明文档",BUTTON_PREVIEW:"下载预览版本",BUTTON_PACKAGE:"下载",BUTTON_GITHUB:"查看源代码",BUTTON_DEMO:"查看示例",SEARCH_PLACEHOLDER:"关键词搜索",LABEL_PREVIEW:"预览版本",LABEL_PLATFORM_ALL:"全平台"}},L=navigator.language.startsWith("zh")?"zh":"en",w=$[L],u=n=>w[n];class _{static async timeout(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}static async nextFrame(){return new Promise(t=>{requestAnimationFrame(()=>{t(!0)})})}}class v{static async startFetching(){const t=await this.fetchData("list.json");f.card.addClass("visible");const e=await this.fetchData(`${r.User}/${r.Owner}/packages?package_type=container`);t.map(async c=>{const a=document.createElement("section");a.addClass("repo"),f.collection.appendChild(a);try{const s=await this.fetchData(`${r.API}/${r.Owner}/${c.name}`),i=await this.fetchData(`${r.API}/${r.Owner}/${c.name}/releases`),h=this.generateNode(c,s,i,e.filter(l=>l.repository.full_name===s.full_name));await this.applyNode(a,h)}catch{a.remove()}})}static async applyNode(t,e){t.innerHTML+=e,await _.nextFrame(),t.addClass("visible")}static generateNode(t,e,c,a=[]){var T,E;const s=c.filter(p=>!p.prerelease)[0],i=c.filter(p=>p.prerelease)[0],h=a.map(p=>`<a class="link-github icon-docker" href="${p.html_url}">${p.name}</a>`),l=`${r.ImageProxy}?url=${r.Content}/${e.full_name}/contents/preview.jpg`,o=`${r.ImageProxy}?url=${r.Content}/${e.full_name}/contents/icon.png`;return`
<div class="repo-cover">
<img src="${l}" srcset="${l}&w=480&h=320h 480w, ${l}&w=960&h=640 960w, ${l}&w=1440&h=960 1440w" sizes="(max-width: 800px) 90vw, (max-width: 1440px) 45vw, 480px" loading="lazy" alt="${e.description}"/>
</div>
<div class="repo-info">
<div class="repo-header">
<div class="repo-icon">
<img src="${o}" srcset="${o}&w=64&h=64 1x, ${o}&w=128&h=128 2x" alt="${e.name}">
</div>
<div class="repo-labelbox">
<span>${e.language}</span>${e.topics.map(p=>`<span>${p}</span>`).join("")}
</div>
<h2 class="repo-title"><a href="${e.html_url}">${t.locale?((T=t.locale[L])==null?void 0:T.full_name)||t.full_name:t.full_name||e.name}</a></h2>
</div>
<ul class="repo-property">
<li class="icon-desktop" title="Platform">${t.platform==="All"?u("LABEL_PLATFORM_ALL"):t.platform}</li>
<li class="icon-tag" title="Latest version">${(s==null?void 0:s.tag_name.toUpperCase())||u("LABEL_PREVIEW")}</li>
<li class="icon-file-code-o" title="Code size">${this.getSize(e.size)}</li>
<li class="icon-calendar" title="Updated time">${this.timeDifference(new Date().getTime(),new Date(e.pushed_at).getTime())}</li>
</ul>
<p class="repo-description">${t.locale?((E=t.locale[L])==null?void 0:E.description)||e.description:e.description??u("BRIEF_NULL")}</p>
<div class="repo-document">
<a class="link icon-github" href="${e.html_url}">${u("BUTTON_GITHUB")}</a>
<a class="link icon-book" href="${t.document}">${u("BUTTON_DOCUMENT")}</a>
<a class="link icon-globe" href="${t.demo??""}">${u("BUTTON_DEMO")}</a>
</div>
<div class="empty"></div>
</div>
<div class="repo-link">
<a class="link-github icon-download" href="${i!=null&&i.assets[0]?`${i.assets[0].url.replace("https://api.github.com/repos",r.Download)}?file=${i.assets[0].name}`:""}">${u("BUTTON_PREVIEW")}</a>
<a class="link-github icon-download" href="${s!=null&&s.assets[0]?`${s.assets[0].url.replace("https://api.github.com/repos",r.Download)}?file=${s.assets[0].name}`:""}">${u("BUTTON_PACKAGE")} ${(s==null?void 0:s.tag_name.toUpperCase())||"Release"}</a>
${h}
</div>
    `}static async fetchData(t){return await fetch(t).then(e=>e.json()).then(e=>e)}static getSize(t){return t<1024?t+"KB":Math.round(t/1024)+"MB"}static timeDifference(t,e){const c=new Intl.RelativeTimeFormat(navigator.language||"en"),a=60*1e3,s=a*60,i=s*24,h=i*30,l=i*365,o=t-e;return o<a?c.format(Math.round(o/1e3)*-1,"second"):o<s?c.format(Math.round(o/a)*-1,"minute"):o<i?c.format(Math.round(o/s)*-1,"hour"):o<h?c.format(Math.round(o/i)*-1,"day"):o<l?c.format(Math.round(o/h)*-1,"month"):c.format(Math.round(o/l)*-1,"year")}}const m=class m{static load(){this.card=document.querySelector(".card"),this.collection=document.querySelector(".collection"),this.searchBox=document.querySelector("#textInput"),this.searchBox.placeholder=u("SEARCH_PLACEHOLDER"),m.query("title").textContent=u("SITE_TITLE"),m.query("#sitename").textContent=u("PAGE_TITLE")}static query(t){return document.querySelector(t)}static queryAll(t){return document.querySelectorAll(t)}};d(m,"card"),d(m,"collection"),d(m,"searchBox");let f=m;HTMLElement.prototype.addClass=function(n){this.classList.contains(n)||this.classList.add(n)};HTMLElement.prototype.removeClass=function(n){this.classList.contains(n)&&this.classList.remove(n)};HTMLElement.prototype.toggleClass=function(n){this.classList.contains(n)?this.classList.remove(n):this.classList.add(n)};HTMLElement.prototype.val=function(n){return n===""?this.value="":n&&(this.value=n),this.value};class A{async start(){await this.waitDocumentReady(),f.load(),v.startFetching(),this.enableSearching()}enableSearching(){let t="";setInterval(()=>{var a;const e=(a=f.searchBox.val())==null?void 0:a.trim().toLowerCase();if(t===e)return;t=e,document.querySelectorAll(".repo").forEach(s=>{var l;if(!e){s.classList.remove("filtered");return}const i=(l=s.textContent)==null?void 0:l.toLowerCase(),h=[...s.querySelectorAll("a")].map(o=>o.href).join(" ").toLowerCase();i!=null&&i.includes(e)||h.includes(e)?s.classList.remove("filtered"):s.classList.add("filtered")})},500)}waitDocumentReady(){return new Promise(t=>{if(document.readyState==="complete"||document.readyState==="interactive")t(!0);else{const e=()=>{document.removeEventListener("DOMContentLoaded",e),t(!0)};document.addEventListener("DOMContentLoaded",e)}})}}const P=new A;P.start();
